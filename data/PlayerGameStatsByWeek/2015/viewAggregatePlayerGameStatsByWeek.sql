/****** Script for SelectTopNRows command from SSMS  ******/
SELECT
	 p.[GameKey]
	,p.[BlockedKickReturnTouchdowns]
	,p.[Stadium]
	,p.[FantasyPoints]
	,p.[FantasyPosition]
	,p.[FieldGoalPercentage]
	,p.[PlayerGameID]
	,p.[FumblesOwnRecoveries]
	,p.[FumblesOutOfBounds]
	,p.[ExtraPointsAttempted]
	,p.[FieldGoalReturnTouchdowns]
	,p.[Safeties]
	,p.[FieldGoalsHadBlocked]
	,p.[PuntsHadBlocked]
	,p.[ExtraPointsHadBlocked]
	,p.[PuntLong]
	,p.[PuntLongnil]
	,p.[FieldGoalReturnYards]
	,p.[PuntNetAverage]
	,p.[KickReturnFairCatches]
	,p.[ShortName]
	,p.[Touchdowns]
	,p.[SafetiesAllowed]
	,p.[TwoPointConversionReceptions]
	,p.[BlockedKickReturnYards]
	,p.[PuntNetYards]
	,p.[SpecialTeamsFumblesForced]
	,p.[SpecialTeamsFumblesRecovered]
	,p.[MiscFumblesForced]
	,p.[FantasyPointsPPR]
	,p.[MiscFumblesRecovered]
	,p.[ReceptionPercentage]
	,p.[ReceivingYardsPerTarget]
	,p.[Tackles]
	,p.[OffensiveTouchdowns]
	,p.[DefensiveTouchdowns]
	,p.[SpecialTeamsTouchdowns]
	,p.[PuntInside20]
	,p.[IsGameOver]
	,p.[PuntReturnFairCatches]
	,p.[PlayingSurface]
	,p.[PlayingSurfacenil]
	,p.[DraftKingsPosition]
	,p.[YahooSalary]
	,p.[YahooSalarynil]
	,p.[FantasyPointsYahoo]
	,p.[InjuryStatus]
	,p.[InjuryBodyPart]
	,p.[InjuryStartDate]
	,p.[InjuryNotes]
	,p.[FanDuelPosition]
	,p.[YahooPosition]
	,p.[FieldGoalsMade50Plus]
	,p.[OpponentRank]
	,p.[OpponentRanknil]
	,p.[OpponentPositionRank]
	,p.[OpponentPositionRanknil]
	,p.[InjuryPractice]
	,p.[InjuryPracticenil]
	,p.[InjuryPracticeDescription]
	,p.[InjuryPracticeDescriptionnil]
	,p.[DeclaredInactive]
	,p.[FantasyDraftSalary]
	,p.[FantasyDraftSalarynil]
	,p.[FantasyDraftPosition]
	,p.[FantasyDraftPositionnil]
	,p.[FantasyPointsDraftKings]
	,p.[FieldGoalsMade40to49]
	,p.[Temperature]
	,p.[SpecialTeamsSnapsPlayed]
	,p.[SpecialTeamsSnapsPlayednil]
	,p.[Humidity]
	,p.[WindSpeed]
	,p.[FanDuelSalary]
	,p.[FanDuelSalarynil]
	,p.[DraftKingsSalary]
	,p.[DraftKingsSalarynil]
	,p.[FantasyDataSalary]
	,p.[FantasyDataSalarynil]
	,p.[OffensiveSnapsPlayed]
	,p.[OffensiveSnapsPlayednil]
	,p.[DefensiveSnapsPlayed]
	,p.[DefensiveSnapsPlayednil]
	,p.[OffensiveTeamSnaps]
	,p.[OffensiveTeamSnapsnil]
	,p.[FieldGoalsMade30to39]
	,p.[DefensiveTeamSnaps]
	,p.[DefensiveTeamSnapsnil]
	,p.[SpecialTeamsTeamSnaps]
	,p.[SpecialTeamsTeamSnapsnil]
	,p.[VictivSalary]
	,p.[VictivSalarynil]
	,p.[TwoPointConversionReturns]
	,p.[FantasyPointsFanDuel]
	,p.[FieldGoalsMade0to19]
	,p.[FieldGoalsMade20to29]
	,p.[PuntTouchbacks]
	,p.[TwoPointConversionRuns]
	,p.[PassingCompletions]
	,p.[PassingYardsPerCompletion]
	,p.[Fumbles]
	,p.[PlayerID]
	,p.[Name]
	,p.[Position]
	,p.[PositionCategory]
	,p.[Activated]
	,p.[Played]
	,p.[PassingYardsPerAttempt]
	,p.[PassingTouchdowns]
	,p.[PassingInterceptions]
	,p.[PassingRating]
	,p.[PassingLong]
	,p.[PassingSacks]
	,p.[PassingSackYards]
	,p.[RushingYards]
	,p.[PassingCompletionPercentage]
	,p.[Started]
	,p.[ReceivingYards]
	,p.[Number]
	,p.[ReceivingLong]
	,p.[TwoPointConversionPasses]
	,p.[RushingAttempts]
	,p.[RushingYardsPerAttempt]
	,p.[RushingTouchdowns]
	,p.[RushingLong]
	,p.[ReceivingTargets]
	,p.[SeasonType]
	,p.[Receptions]
	,p.[Season]
	,p.[GameDate]
	,p.[Week]
	,p.[Team]
	,p.[Opponent]
	,p.[HomeOrAway]
	,p.[PassingYards]
	,p.[ReceivingTouchdowns]
	,p.[PassingAttempts]
	,p.[ReceivingYardsPerReception]
	,p.[MiscSoloTackles]
	,p.[FumbleReturnTouchdowns]
	,p.[Interceptions]
	,p.[InterceptionReturnYards]
	,p.[InterceptionReturnTouchdowns]
	,p.[BlockedKicks]
	,p.[SpecialTeamsSoloTackles]
	,p.[SpecialTeamsAssistedTackles]
	,p.[MiscAssistedTackles]
	,p.[FumblesRecovered]
	,p.[Punts]
	,p.[PuntYards]
	,p.[PuntAverage]
	,p.[FieldGoalsAttempted]
	,p.[FieldGoalsMade]
	,p.[FieldGoalsLongestMade]
	,p.[ExtraPointsMade]
	,p.[FumbleReturnYards]
	,p.[FumblesForced]
	,p.[FumblesLost]
	,p.[KickReturnYardsPerAttempt]
	,p.[PuntReturns]
	,p.[PuntReturnYards]
	,p.[PuntReturnYardsPerAttempt]
	,p.[PuntReturnTouchdowns]
	,p.[PuntReturnLong]
	,p.[KickReturns]
	,p.[KickReturnYards]
	,p.[KickReturnTouchdowns]
	,p.[PassesDefended]
	,p.[KickReturnLong]
	,p.[SoloTackles]
	,p.[AssistedTackles]
	,p.[TacklesForLoss]
	,p.[Sacks]
	,p.[SackYards]
	,p.[QuarterbackHits],

	COUNT(ScoringType) AS 'ScoringTypeCount',
	AVG(Length) AS 'LengthAverage',
	MIN(Length) AS 'LengthMin',
	MAX(Length) AS 'LengthMax'
FROM [tmptmawesome].[dbo].[ArrayOfPlayerGamePlayerGame] p
LEFT JOIN [tmptmawesome].[dbo].[ArrayOfPlayerGamePlayerGameScoringDetailsScoringDetail] d
  ON p.[jpetl_id] = d.[jpetl_idfk]
GROUP BY
	 p.[GameKey]
	,p.[BlockedKickReturnTouchdowns]
	,p.[Stadium]
	,p.[FantasyPoints]
	,p.[FantasyPosition]
	,p.[FieldGoalPercentage]
	,p.[PlayerGameID]
	,p.[FumblesOwnRecoveries]
	,p.[FumblesOutOfBounds]
	,p.[ExtraPointsAttempted]
	,p.[FieldGoalReturnTouchdowns]
	,p.[Safeties]
	,p.[FieldGoalsHadBlocked]
	,p.[PuntsHadBlocked]
	,p.[ExtraPointsHadBlocked]
	,p.[PuntLong]
	,p.[PuntLongnil]
	,p.[FieldGoalReturnYards]
	,p.[PuntNetAverage]
	,p.[KickReturnFairCatches]
	,p.[ShortName]
	,p.[Touchdowns]
	,p.[SafetiesAllowed]
	,p.[TwoPointConversionReceptions]
	,p.[BlockedKickReturnYards]
	,p.[PuntNetYards]
	,p.[SpecialTeamsFumblesForced]
	,p.[SpecialTeamsFumblesRecovered]
	,p.[MiscFumblesForced]
	,p.[FantasyPointsPPR]
	,p.[MiscFumblesRecovered]
	,p.[ReceptionPercentage]
	,p.[ReceivingYardsPerTarget]
	,p.[Tackles]
	,p.[OffensiveTouchdowns]
	,p.[DefensiveTouchdowns]
	,p.[SpecialTeamsTouchdowns]
	,p.[PuntInside20]
	,p.[IsGameOver]
	,p.[PuntReturnFairCatches]
	,p.[PlayingSurface]
	,p.[PlayingSurfacenil]
	,p.[DraftKingsPosition]
	,p.[YahooSalary]
	,p.[YahooSalarynil]
	,p.[FantasyPointsYahoo]
	,p.[InjuryStatus]
	,p.[InjuryBodyPart]
	,p.[InjuryStartDate]
	,p.[InjuryNotes]
	,p.[FanDuelPosition]
	,p.[YahooPosition]
	,p.[FieldGoalsMade50Plus]
	,p.[OpponentRank]
	,p.[OpponentRanknil]
	,p.[OpponentPositionRank]
	,p.[OpponentPositionRanknil]
	,p.[InjuryPractice]
	,p.[InjuryPracticenil]
	,p.[InjuryPracticeDescription]
	,p.[InjuryPracticeDescriptionnil]
	,p.[DeclaredInactive]
	,p.[FantasyDraftSalary]
	,p.[FantasyDraftSalarynil]
	,p.[FantasyDraftPosition]
	,p.[FantasyDraftPositionnil]
	,p.[FantasyPointsDraftKings]
	,p.[FieldGoalsMade40to49]
	,p.[Temperature]
	,p.[SpecialTeamsSnapsPlayed]
	,p.[SpecialTeamsSnapsPlayednil]
	,p.[Humidity]
	,p.[WindSpeed]
	,p.[FanDuelSalary]
	,p.[FanDuelSalarynil]
	,p.[DraftKingsSalary]
	,p.[DraftKingsSalarynil]
	,p.[FantasyDataSalary]
	,p.[FantasyDataSalarynil]
	,p.[OffensiveSnapsPlayed]
	,p.[OffensiveSnapsPlayednil]
	,p.[DefensiveSnapsPlayed]
	,p.[DefensiveSnapsPlayednil]
	,p.[OffensiveTeamSnaps]
	,p.[OffensiveTeamSnapsnil]
	,p.[FieldGoalsMade30to39]
	,p.[DefensiveTeamSnaps]
	,p.[DefensiveTeamSnapsnil]
	,p.[SpecialTeamsTeamSnaps]
	,p.[SpecialTeamsTeamSnapsnil]
	,p.[VictivSalary]
	,p.[VictivSalarynil]
	,p.[TwoPointConversionReturns]
	,p.[FantasyPointsFanDuel]
	,p.[FieldGoalsMade0to19]
	,p.[FieldGoalsMade20to29]
	,p.[PuntTouchbacks]
	,p.[TwoPointConversionRuns]
	,p.[PassingCompletions]
	,p.[PassingYardsPerCompletion]
	,p.[Fumbles]
	,p.[PlayerID]
	,p.[Name]
	,p.[Position]
	,p.[PositionCategory]
	,p.[Activated]
	,p.[Played]
	,p.[PassingYardsPerAttempt]
	,p.[PassingTouchdowns]
	,p.[PassingInterceptions]
	,p.[PassingRating]
	,p.[PassingLong]
	,p.[PassingSacks]
	,p.[PassingSackYards]
	,p.[RushingYards]
	,p.[PassingCompletionPercentage]
	,p.[Started]
	,p.[ReceivingYards]
	,p.[Number]
	,p.[ReceivingLong]
	,p.[TwoPointConversionPasses]
	,p.[RushingAttempts]
	,p.[RushingYardsPerAttempt]
	,p.[RushingTouchdowns]
	,p.[RushingLong]
	,p.[ReceivingTargets]
	,p.[SeasonType]
	,p.[Receptions]
	,p.[Season]
	,p.[GameDate]
	,p.[Week]
	,p.[Team]
	,p.[Opponent]
	,p.[HomeOrAway]
	,p.[PassingYards]
	,p.[ReceivingTouchdowns]
	,p.[PassingAttempts]
	,p.[ReceivingYardsPerReception]
	,p.[MiscSoloTackles]
	,p.[FumbleReturnTouchdowns]
	,p.[Interceptions]
	,p.[InterceptionReturnYards]
	,p.[InterceptionReturnTouchdowns]
	,p.[BlockedKicks]
	,p.[SpecialTeamsSoloTackles]
	,p.[SpecialTeamsAssistedTackles]
	,p.[MiscAssistedTackles]
	,p.[FumblesRecovered]
	,p.[Punts]
	,p.[PuntYards]
	,p.[PuntAverage]
	,p.[FieldGoalsAttempted]
	,p.[FieldGoalsMade]
	,p.[FieldGoalsLongestMade]
	,p.[ExtraPointsMade]
	,p.[FumbleReturnYards]
	,p.[FumblesForced]
	,p.[FumblesLost]
	,p.[KickReturnYardsPerAttempt]
	,p.[PuntReturns]
	,p.[PuntReturnYards]
	,p.[PuntReturnYardsPerAttempt]
	,p.[PuntReturnTouchdowns]
	,p.[PuntReturnLong]
	,p.[KickReturns]
	,p.[KickReturnYards]
	,p.[KickReturnTouchdowns]
	,p.[PassesDefended]
	,p.[KickReturnLong]
	,p.[SoloTackles]
	,p.[AssistedTackles]
	,p.[TacklesForLoss]
	,p.[Sacks]
	,p.[SackYards]
	,p.[QuarterbackHits]
